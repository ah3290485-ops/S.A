<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ÙˆØ¸Ø§ÙŠÙ ğŸ‡¸ğŸ‡¦</title>
  <link rel="stylesheet" href="assets/style.css">
</head>
<body>
  <div class="container">
    <div class="topbar">
      <div class="brand">
        <div class="logo"></div>
        <div>
          <div class="row" style="justify-content:flex-start">
            <span class="badge">ğŸ‡¸ğŸ‡¦</span>
            <span class="badge">Ø°Ù‡Ø¨ÙŠ â€¢ ÙØ¶ÙŠ</span>
          </div>
          <h1>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ÙˆØ¸Ø§ÙŠÙ</h1>
          <p class="small">Ø§Ø®ØªÙØ± Ø§Ù„ÙˆØ¸ÙŠÙØ© ÙˆÙ‚Ø¯Ù‘Ù… Ø§Ù„Ø­ÙŠÙ† â€” ÙˆØ¨ÙŠÙˆØµÙ„ Ø·Ù„Ø¨Ùƒ Ù„Ù„Ø£Ø¯Ù…Ù† Ø¹Ù„Ù‰ ØªÙ„ØºØ±Ø§Ù…</p>
        </div>
      </div>
      <a class="btn primary" href="apply.html">ğŸ“ Ù‚Ø¯Ù‘Ù… Ø§Ù„Ø­ÙŠÙ†</a>
    </div>

    <div class="card">
      <div class="grid two">
        <div>
          <label>Ø§Ø¨Ø­Ø«</label>
          <input id="q" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø¨ÙŠØ¹Ø§Øª / Ù…Ø­Ø§Ø³Ø¨ / ØªØµÙ…ÙŠÙ…...">
        </div>
        <div>
          <label>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</label>
          <select id="city">
            <option value="">ÙƒÙ„ Ø§Ù„Ù…Ø¯Ù†</option>
          </select>
        </div>
      </div>

      <div class="hr"></div>

      <!-- Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ÙˆØ¸Ø§ÙŠÙ (Ø­ÙƒÙˆÙ…ÙŠ/Ø®Ø§Øµ) -->
      <div id="jobs"></div>

      <p class="footer-note">
        ØªÙ†Ø¨ÙŠÙ‡: ÙˆÙ‚Øª Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ù„Ø§Ø²Ù… ØªØ±ÙØ¹ ØµÙˆØ±Ø© Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³Ø© (ÙŠÙØ¶Ù‘Ù„ Ø£Ù‚Ù„ Ù…Ù† <kbd>2MB</kbd>).
      </p>
    </div>
  </div>

  <script type="module">
    import { JOBS } from "./assets/jobs.js";

    const jobsEl = document.querySelector("#jobs");
    const qEl = document.querySelector("#q");
    const cityEl = document.querySelector("#city");

    const cities = [...new Set(JOBS.map(j=>j.city).filter(Boolean))];
    cities.forEach(c=>{
      const o=document.createElement("option");
      o.value=c; o.textContent=c;
      cityEl.appendChild(o);
    });

    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, m => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
      }[m]));
    }

    function jobCard(j){
      return `
        <div class="job" style="${j.category==='gov'?'border:1px solid #d6b25e':''}">
          <div class="row" style="justify-content:space-between;align-items:flex-start">
            <div>
              <h3>${escapeHtml(j.title)}</h3>
              <p>${escapeHtml(j.company)} â€¢ ${escapeHtml(j.city)} â€¢ ${escapeHtml(j.type)}</p>
            </div>
            <a class="btn primary" href="apply.html?job=${encodeURIComponent(j.title)}">Ù‚Ø¯Ù‘Ù… Ø§Ù„Ø­ÙŠÙ†</a>
          </div>
          <div class="hr"></div>
          <p>${escapeHtml(j.desc)}</p>
        </div>
      `;
    }

    function render(){
      const term = (qEl.value||"").trim().toLowerCase();
      const c = cityEl.value;

      const filtered = JOBS.filter(j=>{
        const okTerm = !term || (j.title+" "+j.company+" "+j.desc).toLowerCase().includes(term);
        const okCity = !c || j.city === c;
        return okTerm && okCity;
      });

      const govJobs = filtered.filter(j => j.category === "gov");
      const privateJobs = filtered.filter(j => j.category === "private");

      jobsEl.innerHTML = `
        ${govJobs.length ? `
          <h2 style="color:#d6b25e;margin:10px 0 8px 0">ğŸ› Ø§Ù„ÙˆØ¸Ø§ÙŠÙ Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ©</h2>
          <div class="jobs">${govJobs.map(jobCard).join("")}</div>
        ` : ""}

        ${privateJobs.length ? `
          <h2 style="color:#c9cdd7;margin:18px 0 8px 0">ğŸ’¼ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø®Ø§Øµ</h2>
          <div class="jobs">${privateJobs.map(jobCard).join("")}</div>
        ` : ""}

        ${!filtered.length ? `<div class="notice">Ù…Ø§ Ù„Ù‚ÙŠÙ†Ø§ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©.</div>` : ""}
      `;
    }

    qEl.addEventListener("input", render);
    cityEl.addEventListener("change", render);
    render();
  </script>
</body>
</html>
